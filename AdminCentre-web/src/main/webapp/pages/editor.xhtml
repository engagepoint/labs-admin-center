<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:uib="http://engagepoint.com/uib"
                xmlns:ui-paginator="http://java.sun.com/jsf/composite/uibootstrap/components/paginator"
                template="/WEB-INF/templates/default.xhtml"
                >

    <ui:define name="page">

        <h:form id="preferencesForm">
            <h2><h:outputText value="Preferences administration"/></h2>

            <p:treeTable id="treeTable"
                         value="#{documentsController.root}"
                         var="doc"
                         selectionMode="single"
                         selection="#{documentsController.selectedNode}">  

                <f:facet name="header">
                    Properties Viewer

                    <br/>
                    <p:commandButton value="Edit"  update="treeTable"  action="#{documentsController.selectedNode.data.editAction}" />                  
                    <p:commandButton value="Save"  update="treeTable" action="#{documentsController.selectedNode.data.saveAction}" />
                    <p:commandButton value="Add Node" update="treeTable" action="#{documentsController.addNode}"/>
                    <p:commandButton value="Delete" actionListener="#{documentsController.deleteNode}" update="treeTable"/>
                    <br/>
                    <br/>
                    <br/>
                </f:facet>

                <p:column style="width:30%">
                    <f:facet name="header">
                        File

                    </f:facet>               

                    <p:inputText value="#{doc.name}" style="width:60%" rendered="#{doc.editable}" />  
                    <h:outputText value="#{doc.name}" rendered="#{not doc.editable}" />

                </p:column>

                <p:column style="width:30%">
                    <f:facet name="header">
                        Value
                    </f:facet>

                    <p:inputText value="#{doc.value}" style="width:60%" rendered="#{doc.editable}" />  
                    <h:outputText value="#{doc.value}" rendered="#{not doc.editable}" />           

                </p:column>

                <p:column style="width:30%">
                    <f:facet name="header">
                        Type
                    </f:facet>

                    <p:inputText value="#{doc.type}"  style="width:60%" rendered="#{doc.editable}" />  
                    <h:outputText value="#{doc.type}" rendered="#{not doc.editable}" /> 
                </p:column>

                <p:column style="width:10%">
                    <f:facet name="header">
                        
                    </f:facet>

                    <p:dialog id="delDialog" header="Delete preference" widgetVar="delDlg"  modal="true" height="100" closable="false">

                        <h:outputText value="Realy delete?"/>
                        <br/> 
                        <h:outputText value="#{documentsController.selectedNode.data.name}"/>
                        <br/>

                        <p:commandButton value="Ok"
                                         action="#{documentsController.deleteNode}"
                                         update="treeTable"
                                         oncomplete="delDlg.hide()"/>                        

                        <p:commandButton value="Cancel"
                                         update="treeTable"
                                         oncomplete="delDlg.hide()"/>
                    </p:dialog>

                  
                    <p:commandButton value="Edit" 
                                     update="editDial" 
                                     oncomplete="edDlg.show()" 
                                     styleClass="ui-button-icon-only secondary small"  
                                     icon="ui-icon-edit" />
                    
                    
                    <p:commandButton value="Delete"
                                     immediate="true"
                                     update="treeTable"
                                     styleClass="ui-button-icon-only secondary small"
                                     icon="ui-icon-remove"
                                     oncomplete="delDlg.show()"/>    
                    
                    
                    
                    <p:dialog id="editDial" header="Edit" widgetVar="edDlg"  modal="true" height="200" closable="false">
                        <h:panelGrid  columns="2" cellpadding="5" >  
                            <h:outputLabel for="name" value="Name: " />  
                            <h:outputLabel  value="#{documentsController.selectedNode.data.name}" />  
                            <p:inputText id="name" value="#{documentsController.selectedNode.data.name}" style="font-weight:bold" />  

                            <h:outputLabel for="value" value="Size: " />  
                            <p:inputText id="value" value="#{documentsController.selectedNode.data.value}" style="font-weight:bold" />  

                            <h:outputLabel for="type" value="Type " />  
                            <p:inputText id="type" value="#{documentsController.selectedNode.data.type}" style="font-weight:bold" />  
                        </h:panelGrid>  


                        <p:commandButton value="Ok" oncomplete="edDlg.hide()" update="treeTable"/>

                    </p:dialog>
                    
                </p:column>
            </p:treeTable>
        </h:form>
    </ui:define>
</ui:composition>
